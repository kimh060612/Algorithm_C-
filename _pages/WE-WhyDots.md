---
title: "About"
permalink: /About/WhyDots
layout: posts
author_profile: true
---

## Work Experience in WhyDots

직책: Software development Internship
Role:

1. Face detection, Color tracking 등 Camera를 활용할 수 있는 기능을 개발
2. 로봇의 동작 및 사운드 제어 엔진 소프트웨어 개선
3. 제품의 QA & AS

**사내 보안 규정상 소스코드는 공유할 수 없습니다**

<br>

### 업무 내용
---------------------------------------------------------------------------

<br>

1. Face detection system 구축
    치매 예방을 위한 로봇 Pio의 User Interaction을 위한 Face detection기능을 구현하고 실제 제품에 적용하는 업무를 진행하였습니다.
    <br>
    개발 계기:  

    - 어느날 갑작스럽게 대구 백화점에서 사용 되어야할 Pio의 전시용 컨텐츠가 필요해졌습니다. 이때 콘텐츠 기획팀에서는 지나가는 사람들에게 시선을 계속 보내고 다가오는 사람들을 향에서 인사를 하는 컨탠츠를 생각해 냈습니다.  
    
    - Pio가 아무런 콘텐츠를 진행하고 있지 않은 상황에서 진행면 좋을 콘텐츠 중 하나로써, 사용자를 계속 응시하며 애교를 부리는 행동을 할 수 있는 것이 제시되었습니다.

    <br>
    문제 상황

    - Face detection을 급하게 제작해야하는 상황에서, 제일 처음 떠오른 해답은 Adaboost를 활용하는 것이었습니다. 하지만 이는 만족할만한 정확도가 나오지 않았습니다. 여러 테스트를 거쳐서 앞으로를 위해서라도 정확도가 높고 빠른 Face detection system이 필요하다고 요구하셨습니다.

    - 이때 저는 Deep learning을 활용하는 방법을 떠올렸지만, 추가적인 VPU 같은 장치를 지원받지 못하는 상황이라면 Inference Speed가 너무 느리다는 문제점을 떠올렸습니다.

    <br>
    해결책

    - 처음에는 Cloud Service를 활용하는 방법을 생각해 보았지만, 회사에는 그만큼의 경제적인 여유와 추가적인 시간을 투자할 상황이 아니였습니다. 따라서 저는 Tensorflow Lite를 활용하여 Deep learning 모델을 최적화하여 사용하는 방법을 택하게 되었습니다.
    - WIDER Face, FDDB 같은 유명한 Dataset들을 모은 뒤에 적절한 전처리를 거쳐, Mobilenet SSD, Yolo v3 같은 Object detection 모델을 학습시킨 뒤에, tensorflow Lite로 최적화를 진행하였습니다. 

    <br>
    결과: 결과적으로, Adaboost 만큼 빠르면서 정확도 또한 매우 높은 Face detection model을 만들어 모든 기기에 정상적으로 배포할 수 있었습니다.

<br>

2. Color tracking system 구축
    다양한 상황에서도 정확하게 동작 가능한 Color tracking system을 개발, 색상 카드를 활용하여 사용자와 상호작용하는 게임 콘텐츠에 적용했습니다.

    <br>
    개발 계기:

    - Pio와 함께하는 Robot 주도의 게임중에, 파랑색 원이 그려진 색상카드를 따라 움직이는 것이 있었습니다. 이때 파랑색을 인지하는 기능의 정확도가 주변의 명암과 상황에 따라 너무 차이가 심하여 제가 이를 보완하게 되었습니다.

    <br>
    문제 상황

    - 주변이 너무 어둡거나 밝으면 색상을 제대로 인식하지 못했고, 주변의 다른 파랑색에도 너무 민감하게 반응을 하였습니다.

    <br>
    해결책

    - 주변의 명암과 너무 민감한 문제는, Adaptive Thresholding이라는 알고리즘과 erode-dilate filter로 극복할 수 있었습니다.   

    - 추가적으로 기존의 HSV 영역에서 색을 인지하던 흔해 빠진 알고리즘보다, RGB영역에서 색상을 직접 인지할 수 있는 자체적인 알고리즘을 개발하여 더욱 성능을 높였습니다. 또한, 다른 파랑색 물체를 걸러내기 위해서 Hough 변환을 통해 원을 검출해내어, 파랑색과 원의 영역이 동시에 검출되는 부분을 따라 동작하도록 다시 알고리즘을 수정하였습니다.

    <br> 
    결과: 치매 복지 센터에서 본 콘텐츠에 대하여 계속 제시되던 클레임을 줄일 수 있었습니다.

<br>

3. Robot Engine 구조 개편 및 보완
    Pio의 제어 엔진(모터, 사운드, 통신 등을 제어하는 프로그램)을 구현하는데 생기는 불필요한 반복 작업을 줄이고 메모리 사용량을 줄일 수 있도록 엔진 구조 개선 작업을 진행했습니다.

    <br>
    개발 계기: 

    - Pio의 동작 및 사운드 전반을 제어하는 Engine Software는 급하게 만들어 지느라 코드의 재사용성 및 가독성이 그렇게 좋지 못했습니다. 따라서 이를 수정, 보완하는 작업을 제가 진행하게 되었습니다.
    - 또한, 개발팀에서 Computer Vision을 잘 아시는 분이 안 계셨기 때문에, Engine 구조를 전부 개편할때 제가 없으면  Camera를 사용하는 컨텐츠까지 수정, 보완할 사람이 없었습니다. 따라서 제가 이 작업에 참여하게 되었습니다.

    <br>
    문제 상황
    
    - 우선, 코드의 재사용성이 너무 떨여졌습니다. 단순한 반복 작업이 너무 많았으며 체계적이지 못하게 짜여진 소스코드 때문에 가독성이 메우 떨어져 있었습니다.  
    - Engine위의 모든 Contents가 1개의 process로 돌아가고 있었습니다. 따라서 1개의 기능이 예기치 못하게 죽으면 Engine 전체가 죽어서 Pio의 동작이 완전 정지되는 문제가 있었습니다.

    <br>
    해결책

    - 이전 작업으로 Camera를 활용한 알고리즘들은 전부 별개의 class로써 분리하여 구현하였기 때문에, 이번에는 그들을 총체적으로 관리하는 Camera Process를 새로 설계하였습니다. Main Engine Process와의 IPC를 통해서 어떤 알고리즘을 사용할지 선택하고 결과를 특정 Process에게 보내주는 형식의 class를 설계 및 구현하였습니다. 
    - 이 과정에서 최적화를 통해 기존에 Engine에서 돌리는 것보다 1/3 만의 CPU 사용량으로 동일한 기능을 수행하는 Process를 설계할 수 있었습니다.  또한, Raspberry camera를 제대로 활용하기 위한 모듈을 설치하고 I/O에 관한 Thread는 따로 분리하여 기존 Camera를 활용하는 모든 컨텐츠의 FPS를 최대 2배 이상으로 끌어올릴 수 있었습니다.
    - 기존에 Contents를 구현하기 위해서는 주어진 동작을 수행하는 함수 내에서 반복적인 작업을 계속 수행해야 했습니다. 이를 방지하고자, 동작들에 대한 체계적인 계층적 분류  체계를 새로 만들어서 이를 class의 상속 구조로 구현하였습니다.
    - 그리고 태블릿과 통신하는 전문의 형태를 재 구성해서 이전과 같이 일일히 반복적인 구현을 반복하지 않아도 알아서 동작을 진행할 수 있는 Robot의 제어 엔진 구조를 만들었습니다.

    <br>
    결과: 이렇게 통신 전문 구조와 엔진 전반을 개선하여 Camera를 활용하는 부분의 CPU 사용량, 속도를 향상시키고 제어 엔진 부의 소스코드의  가독성, 재사용성을 끌어올릴 수 있습니다

<br>

4. 업데이트 및 버그 개선 (QA)
    유관부서와 협업하며 개발된 제품의 Test Case 작성 및 Issue Report 관리, 리포트 된 버그 수정, 탑재된 게임 컨텐츠 업데이트, 현장 A/S 등 소프트웨어 QA 전반을 맡아 진행했습니다.

    <br>
    업무 내용:

    - 기획팀과 커뮤니케이션 통해 미 구현/잘못 구현된 부분 파악하여 Issue Report 작성, 코드 수정했습니다. 이 부분을 진행하면서 기획팀의 문서 양식을 서로 합의 하에 새로 만드는 작업을 병행하였습니다. 

    - Test Case 작성 및 Test 진행, 이후 Issue Report 작성하여 버그 수정을 진행하고 Tablet Application과의 통신 문제를 파악/개선하는 업무를 주로 수행하였습니다.


